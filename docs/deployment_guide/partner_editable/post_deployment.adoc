== Test the deployment

. Establish a Remote Desktop Protocol (RDP) connection to both StarWind VSAN EC2 storage instances and to the witness EC2 instance.
. Open the StarWind Management Console on all three EC2 instances. Connect the instances using their management Internet Protocol addresses (IP addresses) or Domain Name System (DNS) names. 
. Verify that the witness instance is synchronized and that its mode is set to *Witness*. 
. Verify that both storage instances (StarWind HA devices) have a health status of `Storage is working properly`. 
. On both storage instances, navigate to *Disk Management* (in Windows, run `compmgmt.msc` and choose *Disk Management*). Verify that the Cluster Shared Volume (CSV) is present and healthy. For details, refer to https://docs.microsoft.com/en-us/windows-server/failover-clustering/failover-cluster-csvs[Use Cluster Shared Volumes in a failover cluster^].

== Postdeployment steps

Configure the Windows Server Failover Cluster as follows:

. Deploy the failover cluster, setting the required name and static IP addresses for it. 

. (Optional) Add IP addresses needed for the cluster and its resources as secondary private IP addresses on the management network interface of the StarWind VSAN EC2 storage instances. For details, see https://www.starwindsoftware.com/resource-library/starwind-virtual-san-for-hyper-v-2-node-hyperconverged-scenario-with-windows-server-2016/#14bdf4cea7ba8ca523dcfb621c1969fa624feec3[Creating a Failover Cluster in Windows Server^] in the StarWind VSAN technical guide.
. Add the StarWind HA device to the cluster. 
.. In **Failover Cluster Manager**, navigate to *Cluster*, *Storage*, *Disks*. 
.. In the *Actions* panel, choose *Add Disk*.
.. Choose *StarWind disks* from the list, and confirm the selection.
.. If you are using the StarWind HA device as a CSV disk, open the context (right-click) menu for the disk, and choose *Add to Cluster Shared Volumes*.
. Set up the failover cluster quorum by creating a Server Message Block (SMB) file share on the StarWind VSAN EC2 witness instance that will host the file share witness for the failover cluster.
. Add a Security Group rule to allow SMB access to the witness node.
.. Open the https://console.aws.amazon.com/ec2/v2[EC2 management console] and select *Security Groups*.
.. Select the security group associated with the EC2 witness instance and add a new inbound rule.
.. Add a rule allowing port 445 TCP traffic from the security group associated with the storage instances.
. Configure file share witness. 
.. Open the context (right-click) menu for the cluster node, navigate to *More Actions*, *Configure Cluster Quorum Settings*, and choose *Next*.
.. Choose the quorum witness, and choose *Next*.
.. Choose *All Nodes* (both StarWind VSAN EC2 Storage instances), and choose *Next*.
.. Choose *Configure a file share witness*, and choose *Next*.
.. In the *File Share Path* box, enter the share path, and choose *Next*.
.. Review the summary page. Then choose *Finish*.

//TODO Dave, In PR 25 (https://github.com/aws-quickstart/quickstart-starwind-vsan/pull/25/files), Hamad edited out all the references to the Windows Server Failover Cluster (or just "cluster") in the "Architecture" section, swapping in the terms "node" or "instance" instead. Please edit this section accordingly so that we use terms consistently throughout. Exception: The link text that points to the StarWind tech guide needs to copy that heading, so there we would keep the term "cluster".

//Marcia, that would be inaccurate. In StarWind parlance, each EC2 instance is a "node", however StarWind runs on top of a Windows Server Failover Cluster. These steps are taken within Windows management consoles rather than within the StarWind application, so they need to maintain the Windows verbiage.
